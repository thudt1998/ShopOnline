function floatToString(a,b){var c=a.toFixed(b).toString();return c.replace(".",Haravan.decimal),c.match("^[."+Haravan.decimal+"]d+")?"0"+c:c}function attributeToString(a){return"string"!=typeof a&&(a+="","undefined"===a&&(a="")),jQuery.trim(a)}"undefined"==typeof Haravan&&(Haravan={}),Haravan.cultures=[{code:"vi-VN",thousands:",",decimal:".",numberdecimal:0,money_format:"{{amount}}"},{code:"en-US",thousands:",",decimal:".",numberdecimal:2,money_format:"{{amount}}"}],Haravan.getCulture=function(a){var b;for(n=0;n<Haravan.cultures.length;n++)if(Haravan.cultures[n].code==a){b=Haravan.cultures[n];break}return b||(b=Haravan.cultures[0]),b},Haravan.format=Haravan.getCulture(Haravan.culture),Haravan.money_format="{{amount}}",Haravan.onError=function(XMLHttpRequest,textStatus){var data=eval("("+XMLHttpRequest.responseText+")");data.message?alert(data.message+"("+data.status+"): "+data.description):alert("Error : "+Haravan.fullMessagesFromErrors(data).join("; ")+".")},Haravan.fullMessagesFromErrors=function(a){var b=[];return jQuery.each(a,function(a,c){jQuery.each(c,function(c,d){b.push(a+" "+d)})}),b},Haravan.onCartUpdate=function(a){alert("There are now "+a.item_count+" items in the cart.")},Haravan.onCartShippingRatesUpdate=function(a,b){var c="";b.zip&&(c+=b.zip+", "),b.province&&(c+=b.province+", "),c+=b.country,alert("There are "+a.length+" shipping rates available for "+c+", starting at "+Haravan.formatMoney(a[0].price)+".")},Haravan.onItemAdded=function(a){alert(a.title+" was added to your shopping cart.")},Haravan.onProduct=function(a){alert("Received everything we ever wanted to know about "+a.title)},Haravan.formatMoney=function(a,b){function f(a){return a.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+Haravan.format.thousands)}a/=100,"string"==typeof a&&(a=a.replace(Haravan.format.thousands,""));var c="",d=/\{\{\s*(\w+)\s*\}\}/,e=b||this.money_format;switch(e.match(d)[1]){case"amount":c=f(floatToString(a,Haravan.format.numberdecimal));break;case"amount_no_decimals":c=f(floatToString(a,0));break;case"amount_with_comma_separator":c=floatToString(a,Haravan.format.numberdecimal).replace(/\./,",");break;case"amount_no_decimals_with_comma_separator":c=f(floatToString(a,0)).replace(/\./,",")}return e.replace(d,c)},Haravan.resizeImage=function(a,b){try{if("original"==b)return a;var c=a.match(/(.*\/[\w\-\_\.]+)\.(\w{2,4})/);return c[1].replace(/http:/g,"")+"_"+b+"."+c[2]}catch(b){return a.replace(/http:/g,"")}},Haravan.addItem=function(a,b,c){var b=b||1,d={type:"POST",url:"/cart/add.js",data:"quantity="+b+"&id="+a,dataType:"json",success:function(a){"function"==typeof c?c(a):Haravan.onItemAdded(a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(d)},Haravan.addItemFromForm=function(a,b){var c={type:"POST",url:"/cart/add.js",data:jQuery("#"+a).serialize(),dataType:"json",success:function(a){"function"==typeof b?b(a):Haravan.onItemAdded(a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(c)},Haravan.getCart=function(a){jQuery.getJSON("/cart.js",function(b,c){"function"==typeof a?a(b):Haravan.onCartUpdate(b)})},Haravan.getCartShippingRatesForDestination=function(a,b){var c={type:"GET",url:"/cart/shipping_rates.json",data:Haravan.param({shipping_address:a}),dataType:"json",success:function(c){rates=c.shipping_rates,"function"==typeof b?b(rates,a):Haravan.onCartShippingRatesUpdate(rates,a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(c)},Haravan.getProduct=function(a,b){jQuery.getJSON("/products/"+a+".js",function(a,c){"function"==typeof b?b(a):Haravan.onProduct(a)})},Haravan.changeItem=function(a,b,c){var d={type:"POST",url:"/cart/change.js",data:"quantity="+b+"&id="+a,dataType:"json",success:function(a){"function"==typeof c?c(a):Haravan.onCartUpdate(a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(d)},Haravan.removeItem=function(a,b){var c={type:"POST",url:"/cart/change.js",data:"quantity=0&id="+a,dataType:"json",success:function(a){"function"==typeof b?b(a):Haravan.onCartUpdate(a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(c)},Haravan.clear=function(a){var b={type:"POST",url:"/cart/clear.js",data:"",dataType:"json",success:function(b){"function"==typeof a?a(b):Haravan.onCartUpdate(b)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(b)},Haravan.updateCartFromForm=function(a,b){var c={type:"POST",url:"/cart/update.js",data:jQuery("#"+a).serialize(),dataType:"json",success:function(a){"function"==typeof b?b(a):Haravan.onCartUpdate(a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(c)},Haravan.updateCartAttributes=function(a,b){var c="";jQuery.isArray(a)?jQuery.each(a,function(a,b){var d=attributeToString(b.key);""!==d&&(c+="attributes["+d+"]="+attributeToString(b.value)+"&")}):"object"==typeof a&&null!==a&&jQuery.each(a,function(a,b){c+="attributes["+attributeToString(a)+"]="+attributeToString(b)+"&"});var d={type:"POST",url:"/cart/update.js",data:c,dataType:"json",success:function(a){"function"==typeof b?b(a):Haravan.onCartUpdate(a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(d)},Haravan.updateCartNote=function(a,b){var c={type:"POST",url:"/cart/update.js",data:"note="+attributeToString(a),dataType:"json",success:function(a){"function"==typeof b?b(a):Haravan.onCartUpdate(a)},error:function(a,b){Haravan.onError(a,b)}};jQuery.ajax(c)},jQuery.fn.jquery>="1.4"?Haravan.param=jQuery.param:(Haravan.param=function(a){var b=[],c=function(a,c){c=jQuery.isFunction(c)?c():c,b[b.length]=encodeURIComponent(a)+"="+encodeURIComponent(c)};if(jQuery.isArray(a)||a.jquery)jQuery.each(a,function(){c(this.name,this.value)});else for(var d in a)Haravan.buildParams(d,a[d],c);return b.join("&").replace(/%20/g,"+")},Haravan.buildParams=function(a,b,c){jQuery.isArray(b)&&b.length?jQuery.each(b,function(b,d){rbracket.test(a)?c(a,d):Haravan.buildParams(a+"["+("object"==typeof d||jQuery.isArray(d)?b:"")+"]",d,c)}):null!=b&&"object"==typeof b?Haravan.isEmptyObject(b)?c(a,""):jQuery.each(b,function(b,d){Haravan.buildParams(a+"["+b+"]",d,c)}):c(a,b)},Haravan.isEmptyObject=function(a){for(var b in a)return!1;return!0});